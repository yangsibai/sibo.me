// Generated by CoffeeScript 1.7.1
(function() {
  var app;

  app = angular.module("app", []);

  app.controller("pinItCtrl", function($scope, apiHelper) {
    var getData;
    $scope.currentState = 0;
    $scope.archive = function(index) {
      var page;
      page = $scope.data[index];
      return apiHelper.get("/pinIt/archive", {
        id: page.id
      }, function(data) {
        if (data.code === 0) {
          return $scope.data.splice(index, 1);
        } else {
          return alert(data.message);
        }
      });
    };
    $scope.getData = function(state) {
      return getData(state);
    };
    getData = function(state) {
      $scope.currentState = state;
      return apiHelper.get("/pinIt/data", {
        state: state
      }, function(data) {
        if (data.code === 0) {
          return $scope.data = data.pageData;
        } else {
          return alert(data.message);
        }
      });
    };
    $scope.search = function(keyword) {
      $scope.currentState = 2;
      return apiHelper.post("/pinIt/search", {
        keyword: keyword
      }, function(data) {
        if (data.code === 0) {
          return $scope.data = data.result;
        } else {
          return alert(data.message);
        }
      });
    };
    return getData(0);
  });

  app.service('apiHelper', function($http) {
    var getServer, postServer;
    this.get = function(apiUrl, params, onSuccess) {
      return getServer(apiUrl, params, onSuccess);
    };
    this.post = function(apiUrl, params, onSuccess) {
      return postServer(apiUrl, params, onSuccess);
    };
    getServer = function(apiUrl, params, onSuccess) {
      if (typeof params === "function") {
        onSuccess = params;
        params = {};
      }
      return $http.get(apiUrl, {
        params: params
      }).success(function(data) {
        return onSuccess(data);
      }).error(function(data, status) {
        console.dir(data);
        return console.log(status);
      });
    };
    postServer = function(apiUrl, params, onSuccess) {
      if (typeof params === "function") {
        onSuccess = params;
        params = {};
      }
      return $http({
        url: apiUrl,
        method: "POST",
        data: JSON.stringify(params),
        headers: {
          'Content-Type': 'application/json'
        }
      }).success(function(data) {
        return onSuccess(data);
      }).error(function(data, status) {
        console.dir(data);
        return console.log(status);
      });
    };
    return void 0;
  });

  app.filter('prettyTime', function() {
    return function(input) {
      var date, day, hour, minute, month, year;
      if (input) {
        date = new Date(input);
        year = date.getFullYear();
        month = date.getMonth() + 1;
        day = date.getDate();
        hour = date.getHours();
        minute = date.getMinutes();
        return month + '/' + day + ',' + year + ' ' + hour + ':' + minute;
      }
    };
  });

}).call(this);

//# sourceMappingURL=app.map
